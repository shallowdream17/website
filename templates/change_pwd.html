<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>浅音乐</title>
<link rel=stylesheet type=text/css href="/static/css/style.css">
</head>

<body>
<div id="Jay">
  <div id="daohanglan">
    <div id="daohangzhongbu">
      <div id="logo"><a href="http://127.0.0.1:8000">浅音乐</a></div>
      <!-- 下拉导航开始 -->
      <div id="my-daohanglan" >
        <ul>
          <li><a href="http://127.0.0.1:8000" >首页</a></li>
          <li><a href="zhuanji" >推荐</a></li>
          <li><a href="" >试听</a> <img src="/static/images/xiajiantou.svg" alt="" width="12" height="12">
            <ul>
              <li><a href="yyh" >千千阙歌</a></li>
          <li><a href="sjmr" >心做し</a></li>
				<li><a href="shbk" >Walk Thru Fire</a></li>
				<li><a href="wsrcxx" >夏天的风</a></li>
            </ul>
          </li>
          {% if users %}
        <li style="color: #fa79d7">欢迎您:<em>{{ users.name }}</em>
        <ul>
            <li><a href="my">个人页面</a></li>
                <li><a href="changepwd">修改密码</a></li>
                <li><a href="logout">注销</a></li>
            {% endif %}
        </ul>
      </div>
      <!-- 下拉导航结束 -->
    </div>
  </div>
  <div id="login">
  <div class="divAll">
<div id="contents">
    <h3>&nbsp;&nbsp;&nbsp;&nbsp; 修改密码</h3>
   <hr width="95%" color="#f2f2f2"/>
      <p style="color:red">&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;{{ errmsg }}</p>
   <form action="" onSubmit="return checkForm()" method="POST">
       {% csrf_token %}
        <div id="form-itemGroup">
            <label for="userPasword">旧  密  码：</label>
            <input type="password" name="user_pwd1" id="userPasword1" class="userName" onBlur="checkPassword1()" oninput="checkPassword1()">
            <span class="default" id="passwordErr1">4到16位的旧密码</span>
        </div>
        <div id="form-itemGroup">
            <label for="userPasword">新  密  码：</label>
            <input type="password" name="user_pwd2" id="userPasword2" class="userName" onBlur="checkPassword2()" oninput="checkPassword2()">
            <span class="default" id="passwordErr2">4到16位的新密码</span>
        </div>
       <div id="form-itemGroup">
           <label for="userConfirmPasword">重 复 新 密 码：</label>
           <input type="password" id="userConfirmPasword" class="userName" onBlur="ConfirmPassword()" oninput="ConfirmPassword()">
           <span class="default" id="conPasswordErr">再次输入</span>
       </div>
        <div>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button type="submit" class="divBtn">提交</button>
        </div>
   </form>
   {% if okmsg %}
     <script>
        var dialog='修改成功!'
        alert(dialog);
        window.location.href="http://127.0.0.1:8000";
     </script>
   {% endif %}
 </div>
</div>


 <script type="text/javascript">
 function checkForm(){
  var passtip1 = checkPassword1();
  var passtip2 = checkPassword2();
  var passtip3 = ConfirmPassword();
  return passtip1 && passtip2 && passtip3;
  }
  //验证密码
function checkPassword1(){
  var userpasswd = document.getElementById('userPasword1');
  var errPasswd = document.getElementById('passwordErr1');
  var pattern = /^\w{4,16}$/; //密码要在4-8位
  if(!pattern.test(userpasswd.value)){
    errPasswd.innerHTML="密码不合规范"
    errPasswd.className="error"
    return false;
    }
   else{
     errPasswd.innerHTML="OK"
     errPasswd.className="success";
     return true;
     }
  }
  function checkPassword2(){
  var userpasswd = document.getElementById('userPasword2');
  var errPasswd = document.getElementById('passwordErr2');
  var pattern = /^\w{4,16}$/; //密码要在4-8位
  if(!pattern.test(userpasswd.value)){
    errPasswd.innerHTML="密码不合规范"
    errPasswd.className="error"
    return false;
    }
   else{
     errPasswd.innerHTML="OK"
     errPasswd.className="success";
     return true;
     }
  }
  function ConfirmPassword(){
  var userpasswd = document.getElementById('userPasword2');
  var userConPassword = document.getElementById('userConfirmPasword');
  var errConPasswd = document.getElementById('conPasswordErr');
  if((userpasswd.value)!=(userConPassword.value) || userConPassword.value.length == 0){
    errConPasswd.innerHTML="上下密码不一致"
    errConPasswd.className="error"
    return false;
    }
   else{
     errConPasswd.innerHTML="OK"
     errConPasswd.className="success";
     return true;
     }
  }

</script>
  </div>
<div id="dibu">
    <div id="dibuzhongbu">
    <table width="1048" border="0">
  <tr>
    <td align="center">&nbsp;</td>
  </tr>
<tr>
    <td align="center">&nbsp;&nbsp; 浅音乐</td>
  </tr>
  <tr>
    <td align="center">© 2021 SHALLOW DREAM.All Rights Reserved.</td>
  </tr>
</table>

    </div>
  </div>
</div>
</body>
</html>
